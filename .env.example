# GPG Webservice Configuration
# Copy this file to .env and customize for your environment

# Flask Environment
FLASK_ENV=development  # development, testing, production
SECRET_KEY=your-secret-key-here-change-in-production
DEBUG=false
TESTING=false

# Database
# SQLite (development/testing)
DATABASE_URL=sqlite:///gpg_users.db
# PostgreSQL (production recommended)
# DATABASE_URL=postgresql://user:password@localhost:5432/gpg_webservice
# MySQL
# DATABASE_URL=mysql://user:password@localhost:3306/gpg_webservice

# File Uploads
UPLOAD_FOLDER=/tmp/gpg_uploads
MAX_CONTENT_LENGTH=16777216  # 16MB in bytes
MAX_FILE_SIZE_MB=10
MAX_SIGNATURE_SIZE_MB=1

# Rate Limiting
RATE_LIMIT_AUTH_REQUESTS=5  # Authentication attempts per window
RATE_LIMIT_AUTH_WINDOW=60   # Window in seconds
RATE_LIMIT_API_REQUESTS=30  # API calls per window
RATE_LIMIT_API_WINDOW=60    # Window in seconds

# Challenge Settings
CHALLENGE_MAX_PER_USER=100
CHALLENGE_MAX_AGE_DAYS=7

# Username Validation
USERNAME_MIN_LENGTH=3
USERNAME_MAX_LENGTH=50

# Password Validation
PASSWORD_MIN_LENGTH=8
PASSWORD_MAX_LENGTH=128
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_DIGIT=true
PASSWORD_REQUIRE_SPECIAL=true

# Email Validation
EMAIL_MAX_LENGTH=254

# Security Headers
SECURITY_HEADERS_ENABLED=true
HSTS_MAX_AGE=31536000  # 1 year in seconds
CSP_POLICY=default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'

# Logging
LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_FORMAT=json  # json or text
LOG_FILE=  # Leave empty for stdout only, or specify path
AUDIT_LOG_FILE=audit.log

# GPG Settings
GPG_KEYSTORE_PATH=/srv/gpg-keystore
GPG_KEY_LENGTH=3072  # RSA key length: 2048, 3072, or 4096
GPG_KEY_TYPE=RSA

# API Keys
API_KEY_LENGTH=32  # Length in bytes before base64 encoding
API_KEY_HASH_ALGORITHM=sha256

# PBKDF2 Settings (for GPG passphrase derivation)
PBKDF2_ITERATIONS=100000
PBKDF2_ALGORITHM=sha256

# OpenAI Integration (if using)
# OPENAI_API_KEY=your-openai-api-key-here
